import{j as s,Y as e}from"./vendor-ui-DcvuiMJW.js";import{u as o}from"./useQuery-BWx6GIbP.js";import{e as i,E as t,n,o as r,B as a,F as l}from"./index-DwPe7WlF.js";import{u as m}from"./useMutation-DJeY6rhC.js";import{S as c,H as d}from"./Header-B444uWW8.js";import{F as g}from"./Footer-DqaNDUWV.js";import{O as x}from"./OptimizedImage-DunbvjKP.js";import{M as u}from"./MobileNav-BeTlynVm.js";import{L as p}from"./Loading-CC70LVJ3.js";import{u as j}from"./useTranslation-BptfK32d.js";import"./vendor-react-CPc5zwff.js";import"./useBaseQuery-3Lu_M2RN.js";import"./vendor-charts-CNjKuHaK.js";import"./vendor-utils-tyqSID0v.js";import"./LanguageSwitcher-kkyV-vkk.js";import"./index-B9HPLTtY.js";const h=({status:e})=>{const{t:o}=j(),i="confirmed"===e?"bg-green-100 text-green-700":"pending"===e?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700";return s.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold capitalize ${i}`,children:o(`myBookings.status.${e}`)})};function f(){const{t:f}=j(),y=i(),{data:b,isLoading:k,error:v}=o({queryKey:["my-bookings"],queryFn:t}),w=m({mutationFn:l,onSuccess:()=>{e.success(f("myBookings.cancelSuccess")),y.invalidateQueries({queryKey:["my-bookings"]})},onError:()=>{e.error(f("myBookings.cancelError"))}});return s.jsxs("div",{className:"min-h-screen bg-white pb-20 md:pb-0",children:[s.jsx(c,{title:f("myBookings.title"),description:f("myBookings.seoDescription",{count:(null==b?void 0:b.length)||0})}),s.jsx(d,{}),s.jsxs("main",{className:"max-w-5xl mx-auto px-4 sm:px-6 py-8",children:[s.jsx("h1",{className:"text-2xl font-bold mb-6",children:f("myBookings.title")}),k&&s.jsx(p,{message:f("common.loading")}),v&&s.jsx("div",{className:"text-red-600",children:f("common.error")}),!k&&!v&&(b&&b.length>0?s.jsx("div",{className:"grid grid-cols-1 gap-4",children:b.map(e=>s.jsxs("div",{className:"border rounded-xl p-4 flex flex-col sm:flex-row gap-4 items-start sm:items-center bg-white",children:[s.jsxs("div",{className:"flex gap-4 w-full sm:w-auto flex-1",children:[s.jsx(x,{src:e.listing_photo?n(e.listing_photo):"/bathroom-placeholder.jpg",alt:"Listing",className:"w-24 h-24 object-cover rounded-lg cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>window.location.href=`/product/${e.booking.listing_id}`,onError:()=>{}}),s.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>window.location.href=`/product/${e.booking.listing_id}`,children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"font-semibold text-lg line-clamp-1 hover:underline",children:e.listing_title}),s.jsx(h,{status:e.booking.status})]}),s.jsx("div",{className:"text-sm text-gray-600",children:(e.listing_city||"")+(e.listing_city&&e.listing_country?", ":"")+(e.listing_country||"")}),s.jsxs("div",{className:"text-sm mt-1",children:[new Date(e.booking.check_in).toLocaleDateString()," - ",new Date(e.booking.check_out).toLocaleDateString()," Â· ",f("common.guest_count",{count:e.booking.guests})]}),s.jsx("div",{className:"text-sm font-semibold mt-1",children:f("myBookings.total",{price:r(e.booking.total_price)})})]})]}),s.jsxs("div",{className:"flex flex-row gap-2 w-full sm:w-auto mt-2 sm:mt-0",children:[s.jsx(a,{className:"flex-1 sm:flex-none",variant:"outline",size:"sm",onClick:()=>window.location.href=`/product/${e.booking.listing_id}`,children:f("myBookings.viewListing")}),("pending"===e.booking.status||"confirmed"===e.booking.status)&&s.jsx(a,{className:"flex-1 sm:flex-none",variant:"destructive",size:"sm",onClick:()=>{return s=e.booking.id,void(confirm(f("myBookings.cancelConfirm"))&&w.mutate(s));var s},disabled:w.isPending,children:f("myBookings.cancel")})]})]},e.booking.id))}):s.jsxs("div",{className:"border rounded-xl p-8 text-center bg-white",children:[s.jsx("div",{className:"text-lg font-medium mb-2",children:f("myBookings.empty.title")}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:f("myBookings.empty.description")}),s.jsx(a,{onClick:()=>window.location.href="/marketplace",children:f("myBookings.empty.button")})]}))]}),s.jsx(g,{}),s.jsx(u,{})]})}export{f as default};
