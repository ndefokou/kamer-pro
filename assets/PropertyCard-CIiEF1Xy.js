import{j as e,I as s,J as t}from"./vendor-ui-CAOOb9ur.js";import{r as a,L as r}from"./vendor-react-C_40T_Qy.js";import{m as o,n as i,o as l,B as n,p as c,q as m}from"./index-CHW3rl59.js";import{u as d}from"./useWishlist-XpO0FfUG.js";import{O as p}from"./OptimizedImage-ChM7nsgN.js";import{T as u}from"./TranslatedText-BL0fQdvT.js";import{p as x}from"./propertyTypes-lVvLaZHM.js";import{u as h}from"./useTranslation-DgYtz7Wb.js";const f=a.memo(({id:f,name:g,location:j,price:v,images:b,rating:w,isGuestFavorite:N=!1,priority:y=!1,propertyType:k})=>{var F,T;const z=o(),[$,P]=a.useState(0),{isInWishlist:q,addToWishlist:W,removeFromWishlistByProduct:B}=d(),{toast:C}=i(),{t:D}=h(),I=q(f),L=()=>{z.prefetchQuery({queryKey:["listing",f],queryFn:()=>m(f)})},E=b&&b.length>1;return e.jsx(r,{to:`/product/${f}`,className:"block flex-shrink-0 w-full sm:w-[280px] group cursor-pointer",onMouseEnter:L,onFocus:L,onTouchStart:L,children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"relative aspect-[20/19] sm:aspect-square rounded-xl overflow-hidden bg-muted mb-3",children:[b&&b.length>0?e.jsx(p,{src:l(null==(F=b[$])?void 0:F.image_url),alt:g,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500 ease-out",priority:y}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-muted text-muted-foreground",children:e.jsx("span",{className:"text-sm",children:D("host.editor.noPhotosYet")})}),N&&e.jsx("div",{className:"absolute top-3 left-3 z-10",children:e.jsxs("span",{className:"px-3 py-1 text-xs font-bold bg-white/90 backdrop-blur-sm text-foreground rounded-full shadow-sm flex items-center gap-1",children:[e.jsx(s,{className:"h-3 w-3 fill-current"}),D("Guest favorite")]})}),e.jsx(n,{variant:"ghost",size:"icon",className:"absolute top-3 right-3 z-10 h-8 w-8 rounded-full hover:bg-white/90 hover:scale-110 transition-all p-0 focus:ring-0",onClick:async e=>{e.preventDefault(),e.stopPropagation();try{const e=f;I?await B(e):await W(e)}catch(s){C({title:"Error",description:"Failed to update wishlist",variant:"destructive"})}},children:e.jsx(t,{className:"h-6 w-6 transition-colors "+(I?"fill-green-600 text-green-600":"fill-black/50 text-white stroke-[2px]")})}),E&&e.jsx("div",{className:"absolute bottom-3 left-1/2 -translate-x-1/2 flex gap-1.5 z-10 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:b.slice(0,5).map((s,t)=>e.jsx("button",{className:"h-1.5 rounded-full transition-all shadow-sm "+(t===$?"w-1.5 bg-white scale-125":"w-1.5 bg-white/60 hover:bg-white/80"),onClick:e=>{e.preventDefault(),e.stopPropagation(),P(t)},"aria-label":`View image ${t+1}`},t))}),e.jsx("div",{className:"absolute inset-x-0 bottom-0 h-8 bg-gradient-to-t from-black/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("h3",{className:"font-semibold text-[15px] text-foreground line-clamp-1 group-hover:text-primary transition-colors",children:(()=>{if(!j)return g;const e=k||"",s=["room","apartment","studio","villa","house"].find(s=>s===e)||e||"home",t=j.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/\s+/g,"");return`${D(`categories.${s}`,s)} • ${D(`locations.${t}`,j)}`})()}),w&&e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.jsx(s,{className:"h-3 w-3 fill-current text-foreground"}),e.jsx("span",{className:"text-sm text-foreground",children:w.toFixed(2)})]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground line-clamp-1",children:[g,k&&e.jsxs(e.Fragment,{children:[" • ",e.jsx(u,{as:"span",text:(null==(T=x.find(e=>e.id===k))?void 0:T.label)||k})]})]}),e.jsxs("div",{className:"flex items-baseline gap-1 mt-1",children:[e.jsx("span",{className:"font-semibold text-[15px] text-foreground",children:c(v)}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["/ ",D("per night")]})]})]})]})})});export{f as P};
