import{a5 as g,j as e,E as x,G as p,B as n,a9 as u,V as c,aa as f}from"./index-BumHlSai.js";import{u as h}from"./useQuery-wQaSLt0g.js";import{u as y}from"./useMutation-BI-sjjQw.js";import{S as k,H as j}from"./Header-CQjoyTD4.js";import{F as w}from"./Footer-D_4nY92E.js";import{O as v}from"./OptimizedImage-xP7m_j1R.js";import{M as N}from"./MobileNav-DOEiLKDh.js";import{L as b}from"./Loading-wlpE3RCN.js";import{u as m}from"./useTranslation-DUME4FCN.js";import"./LanguageSwitcher-B49yhAFl.js";import"./index-BcTPR2G6.js";import"./chevron-right-Cey3u9Ra.js";import"./check-Cw4ObBPz.js";import"./chevron-left-BgQrOA8v.js";import"./menu-CwDdBYwq.js";import"./heart-DX2l2ZpK.js";import"./calendar-B4NFKoEL.js";import"./message-square-BTQwkIw7.js";const B=({status:i})=>{const{t}=m(),s=i==="confirmed"?"bg-green-100 text-green-700":i==="pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700";return e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-semibold capitalize ${s}`,children:t(`myBookings.status.${i}`)})};function R(){const{t:i}=m(),t=g(),{data:s,isLoading:r,error:a}=h({queryKey:["my-bookings"],queryFn:f}),l=y({mutationFn:u,onSuccess:()=>{c.success(i("myBookings.cancelSuccess")),t.invalidateQueries({queryKey:["my-bookings"]})},onError:()=>{c.error(i("myBookings.cancelError"))}}),d=o=>{confirm(i("myBookings.cancelConfirm"))&&l.mutate(o)};return e.jsxs("div",{className:"min-h-screen bg-white pb-20 md:pb-0",children:[e.jsx(k,{title:i("myBookings.title"),description:i("myBookings.seoDescription",{count:(s==null?void 0:s.length)||0})}),e.jsx(j,{}),e.jsxs("main",{className:"max-w-5xl mx-auto px-4 sm:px-6 py-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:i("myBookings.title")}),r&&e.jsx(b,{message:i("common.loading")}),a&&e.jsx("div",{className:"text-red-600",children:i("common.error")}),!r&&!a&&(s&&s.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4",children:s.map(o=>e.jsxs("div",{className:"border rounded-xl p-4 flex flex-col sm:flex-row gap-4 items-start sm:items-center bg-white",children:[e.jsxs("div",{className:"flex gap-4 w-full sm:w-auto flex-1",children:[e.jsx(v,{src:o.listing_photo?x(o.listing_photo):"/bathroom-placeholder.jpg",alt:"Listing",className:"w-24 h-24 object-cover rounded-lg cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>window.location.href=`/product/${o.booking.listing_id}`,onError:()=>{}}),e.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>window.location.href=`/product/${o.booking.listing_id}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-lg line-clamp-1 hover:underline",children:o.listing_title}),e.jsx(B,{status:o.booking.status})]}),e.jsx("div",{className:"text-sm text-gray-600",children:(o.listing_city||"")+(o.listing_city&&o.listing_country?", ":"")+(o.listing_country||"")}),e.jsxs("div",{className:"text-sm mt-1",children:[new Date(o.booking.check_in).toLocaleDateString()," - ",new Date(o.booking.check_out).toLocaleDateString()," Â· ",i("common.guest_count",{count:o.booking.guests})]}),e.jsx("div",{className:"text-sm font-semibold mt-1",children:i("myBookings.total",{price:p(o.booking.total_price)})})]})]}),e.jsxs("div",{className:"flex flex-row gap-2 w-full sm:w-auto mt-2 sm:mt-0",children:[e.jsx(n,{className:"flex-1 sm:flex-none",variant:"outline",size:"sm",onClick:()=>window.location.href=`/product/${o.booking.listing_id}`,children:i("myBookings.viewListing")}),(o.booking.status==="pending"||o.booking.status==="confirmed")&&e.jsx(n,{className:"flex-1 sm:flex-none",variant:"destructive",size:"sm",onClick:()=>d(o.booking.id),disabled:l.isPending,children:i("myBookings.cancel")})]})]},o.booking.id))}):e.jsxs("div",{className:"border rounded-xl p-8 text-center bg-white",children:[e.jsx("div",{className:"text-lg font-medium mb-2",children:i("myBookings.empty.title")}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:i("myBookings.empty.description")}),e.jsx(n,{onClick:()=>window.location.href="/marketplace",children:i("myBookings.empty.button")})]}))]}),e.jsx(w,{}),e.jsx(N,{})]})}export{R as default};
