const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ReviewModal-n10c18oF.js","assets/vendor-ui-DcvuiMJW.js","assets/vendor-react-CPc5zwff.js","assets/index-DwPe7WlF.js","assets/vendor-charts-CNjKuHaK.js","assets/vendor-utils-tyqSID0v.js","assets/index-lw8G4jxF.css","assets/textarea-B_LOwP_O.js","assets/label-n6J90QQJ.js","assets/ShareModal-HHH9c7rp.js","assets/OptimizedImage-DunbvjKP.js","assets/MessageHostModal-CE9H-CJc.js","assets/ReportHostModal-D_2rKcdx.js","assets/PhotoGallery-Cvx6VrCX.js","assets/ListingMap-DGDgXnG7.js","assets/vendor-maps-DGfzlnCx.js","assets/marker-shadow-D5DIcCoR.js","assets/marker-shadow-Dgihpmma.css","assets/useTranslation-BptfK32d.js"])))=>i.map(i=>d[i]);
import{c as e,m as s,B as t,n as i,o as l,D as a,p as n,q as r,r as o,s as d,f as c,t as m,_ as u,v as h,w as x}from"./index-DwPe7WlF.js";import{j as g,c as p,P as v,K as j,J as f,I as b,M as N,z as y,G as w,N as _,Q as k,X as C,r as S,q as D}from"./vendor-ui-DcvuiMJW.js";import{r as I,k as M,e as P,R as F}from"./vendor-react-CPc5zwff.js";import{u as R}from"./useQuery-BWx6GIbP.js";import{L as O}from"./Loading-CC70LVJ3.js";import{O as $}from"./OptimizedImage-DunbvjKP.js";import{o as A}from"./whatsapp-B6PH0vCN.js";import{D as T,A as E}from"./HouseRulesSection-zgccbfet.js";import{F as L}from"./Footer-DqaNDUWV.js";import{S as q,H as z}from"./Header-B444uWW8.js";import{D as H}from"./index.esm-D78Y81EZ.js";import{A as V,a as Y,b as W}from"./avatar-B5sUQZ8R.js";import{u as B}from"./useWishlist-C3hKKQtd.js";import{T as G}from"./TranslatedText-B-87mhZr.js";import{u as J}from"./useTranslation-BptfK32d.js";import{f as U}from"./fr-qjbnyBeO.js";import{e as K,f as Q}from"./vendor-utils-tyqSID0v.js";import"./vendor-charts-CNjKuHaK.js";import"./useBaseQuery-3Lu_M2RN.js";import"./LanguageSwitcher-kkyV-vkk.js";import"./index-B9HPLTtY.js";var X="Progress",[Z]=p(X),[ee,se]=Z(X),te=I.forwardRef((e,s)=>{const{__scopeProgress:t,value:i=null,max:l,getValueLabel:a=ae,...n}=e;(l||0===l)&&oe(l);const r=oe(l)?l:100;null!==i&&de(i,r);const o=de(i,r)?i:null,d=re(o)?a(o,r):void 0;return g.jsx(ee,{scope:t,value:o,max:r,children:g.jsx(v.div,{"aria-valuemax":r,"aria-valuemin":0,"aria-valuenow":re(o)?o:void 0,"aria-valuetext":d,role:"progressbar","data-state":ne(o,r),"data-value":o??void 0,"data-max":r,...n,ref:s})})});te.displayName=X;var ie="ProgressIndicator",le=I.forwardRef((e,s)=>{const{__scopeProgress:t,...i}=e,l=se(ie,t);return g.jsx(v.div,{"data-state":ne(l.value,l.max),"data-value":l.value??void 0,"data-max":l.max,...i,ref:s})});function ae(e,s){return`${Math.round(e/s*100)}%`}function ne(e,s){return null==e?"indeterminate":e===s?"complete":"loading"}function re(e){return"number"==typeof e}function oe(e){return re(e)&&!isNaN(e)&&e>0}function de(e,s){return re(e)&&!isNaN(e)&&e<=s&&e>=0}le.displayName=ie;var ce=te,me=le;const ue=I.forwardRef(({className:s,value:t,...i},l)=>g.jsx(ce,{ref:l,className:e("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...i,children:g.jsx(me,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));ue.displayName=ce.displayName;const he=I.lazy(()=>u(()=>import("./ReviewModal-n10c18oF.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8]))),xe=I.lazy(()=>u(()=>import("./ShareModal-HHH9c7rp.js"),__vite__mapDeps([9,1,2,3,4,5,6,10]))),ge=I.lazy(()=>u(()=>import("./MessageHostModal-CE9H-CJc.js"),__vite__mapDeps([11,1,2,3,4,5,6,7]))),pe=I.lazy(()=>u(()=>import("./ReportHostModal-D_2rKcdx.js"),__vite__mapDeps([12,1,2,3,4,5,6,8,7]))),ve=I.lazy(()=>u(()=>import("./PhotoGallery-Cvx6VrCX.js"),__vite__mapDeps([13,1,2,3,4,5,6,10]))),je=I.lazy(()=>u(()=>import("./ListingMap-DGDgXnG7.js"),__vite__mapDeps([14,1,2,15,16,17,18,3,4,5,6]))),fe=()=>{var e,u;const{id:p}=M(),v=P(),{addToWishlist:X,removeFromWishlistByProduct:Z,isInWishlist:ee}=B(),{data:se,isLoading:te,error:ie,refetch:le}=R({queryKey:["listing",p],queryFn:()=>c(p),enabled:!!p});F.useEffect(()=>{if(!p)return;let e=null;const s=e=>{const s=e.detail;(null==s?void 0:s.listingId)===p&&le()};try{"BroadcastChannel"in window&&(e=new BroadcastChannel("calendar-updates"),e.onmessage=e=>{const s=e.data;"calendar_updated"===(null==s?void 0:s.type)&&s.listingId===p&&le()})}catch{}return window.addEventListener("calendar_updated",s),()=>{window.removeEventListener("calendar_updated",s);try{null==e||e.close()}catch{}}},[p,le]);const[ae,ne]=F.useState(null),[re,oe]=F.useState(null),[de,ce]=F.useState(1),[me,fe]=F.useState(0),[be,Ne]=F.useState(0),[ye,we]=F.useState(0),[_e,ke]=F.useState(!1),[Ce,Se]=F.useState(new Date),[De,Ie]=F.useState(!1),[Me,Pe]=F.useState(!1),[Fe,Re]=F.useState(!1),[Oe,$e]=F.useState(!1),[Ae,Te]=F.useState(!1),[Ee,Le]=F.useState(!1),[qe,ze]=F.useState(!1),{t:He,i18n:Ve}=J(),Ye="fr"===Ve.language?U:K,We=(null==(e=Ve.language)?void 0:e.startsWith("fr"))?"fr-FR":"en-US",[Be,Ge]=F.useState(0),[Je,Ue]=F.useState([]),{toast:Ke}=s(),Qe=F.useRef(null),Xe=F.useRef(null),Ze=()=>{var e,s;try{null==(s=null==(e=document.activeElement)?void 0:e.blur)||s.call(e)}catch{}Pe(!0)},es=F.useCallback(e=>{let s={cleanliness:5,accuracy:5,checkin:5,communication:5,location:5,value:5};try{e.ratings&&"string"==typeof e.ratings&&(s=JSON.parse(e.ratings)),e.ratings&&"object"==typeof e.ratings&&(s=e.ratings)}catch{}return{id:Number(e.id),user:{name:e.username||"Guest",avatar:e.avatar||"https://github.com/shadcn.png"},guestId:Number(e.guest_id),ratings:s,comment:e.comment||"",timestamp:e.created_at||(new Date).toISOString()}},[]),{data:ss,isLoading:ts}=R({queryKey:["reviews",p],queryFn:()=>m(p),enabled:!!p});F.useEffect(()=>{ss&&Ue(ss.map(es))},[ss,es]);const is=F.useMemo(()=>(null==se?void 0:se.photos)?[...se.photos].sort((e,s)=>Number(s.is_cover)-Number(e.is_cover)):[],[null==se?void 0:se.photos]),ls=F.useMemo(()=>(null==se?void 0:se.unavailable_dates)?se.unavailable_dates.map(e=>({from:new Date(e.check_in),to:new Date(e.check_out)})):[],[null==se?void 0:se.unavailable_dates]);if(te)return g.jsx(O,{fullScreen:!0,message:He("common.loading","Loading...")});if(ie||!se)return g.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center gap-4",children:[g.jsx("h1",{className:"text-2xl font-bold",children:He("listing.errors.notFound")}),g.jsx(t,{onClick:()=>v("/"),children:He("listing.actions.goHome")})]});const{listing:as,amenities:ns}=se,rs=(se.host_username||"").trim()||"Host",os=se.host_avatar??localStorage.getItem("host_avatar")??void 0,ds=de+me,cs=Number(localStorage.getItem("userId"))===Number(as.host_id),ms=Number(localStorage.getItem("userId")||"")||null,us=ee(as.id),hs=!!ms&&Je.some(e=>e.guestId===ms),xs=ae&&re?Math.ceil((re.getTime()-ae.getTime())/864e5):0,gs=xs*(as.price_per_night||0),ps=gs+0,vs=(e,s)=>!!e&&(e.getDate()===s.getDate()&&e.getMonth()===s.getMonth()&&e.getFullYear()===s.getFullYear()),js=e=>!(!ae||!re)&&(e>ae&&e<re),fs=e=>!!(e<new Date((new Date).setHours(0,0,0,0)))||ls.some(s=>e>=s.from&&e<s.to),bs=e=>{if(!fs(e))if(!ae||ae&&re)ne(e),oe(null);else if(e>ae){if(ls.some(s=>s.from>ae&&s.from<e||s.to>ae&&s.to<e||s.from<=ae&&s.to>=e))return void Ke({title:"Dates unavailable",description:"Selected range includes unavailable dates.",variant:"destructive"});oe(e)}else ne(e),oe(null)},Ns=()=>{Se(new Date(Ce.getFullYear(),Ce.getMonth()+1))},ys=()=>{Se(new Date(Ce.getFullYear(),Ce.getMonth()-1))},ws=async()=>{if(cs)return void Ke({title:"Not allowed",description:"You cannot reserve your own listing.",variant:"destructive"});if(!ae||!re)return void Ie(!0);if(!!!localStorage.getItem("userId"))return Ke({title:"Account required",description:"Please create an account or log in to reserve a listing.",variant:"destructive"}),void(window.location.href=`/login?tab=register&redirect=${encodeURIComponent("/")}`);if((as.max_guests||0)>0&&ds>(as.max_guests||0))Ke({title:"Too many guests",description:`This place allows up to ${as.max_guests} guests. Reduce the number of guests to continue.`,variant:"destructive"});else try{await x({listing_id:as.id,check_in:Q(ae,"yyyy-MM-dd"),check_out:Q(re,"yyyy-MM-dd"),guests:ds}),Ke({title:"Reservation successful",description:"Your reservation request has been sent."}),v("/bookings")}catch(e){Ke({title:"Reservation failed",description:"Please try again.",variant:"destructive"})}};let _s=T;try{_s=as.house_rules?JSON.parse(as.house_rules):T}catch(Ss){_s=T}let ks=[],Cs=as.description||null;try{if(as.description&&as.description.trim().startsWith("{")){const e=JSON.parse(as.description);ks=[["listingDescription",He("listing.details.about")],["propertyDetails",He("propertyDetails")],["guestAccess",He("guestAccess")],["guestInteraction",He("guestInteraction")],["otherNotes",He("otherNotes")],["otherDetails",He("otherDetails")]].map(([s,t])=>({title:t,text:"string"==typeof e[s]?e[s].trim():""})).filter(e=>e.text),ks.length>0&&(Cs=null)}}catch(Ss){ks=[],Cs=as.description||null}return g.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[g.jsx(q,{title:as.title||He("listing.details.untitled"),description:(null==(u=as.description)?void 0:u.substring(0,160))||He("listing.details.seoDescription"),image:is[0]?i(is[0].url):void 0,type:"article"}),g.jsx(z,{}),g.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[g.jsxs("div",{className:"flex justify-between items-start mb-6",children:[g.jsxs("div",{children:[g.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-2",children:g.jsx(G,{as:"span",text:as.title})}),g.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[g.jsxs("span",{className:"font-medium text-foreground",children:["★ ",He("listing.details.new")]}),g.jsx("span",{children:"•"}),g.jsxs("span",{className:"underline",children:[as.city,", ",as.country]})]})]}),g.jsxs("div",{className:"flex gap-2",children:[g.jsxs(t,{variant:"outline",size:"sm",className:"gap-2",onClick:()=>$e(!0),children:[g.jsx(j,{className:"h-4 w-4"}),He("listing.actions.share")]}),g.jsxs(t,{variant:"outline",size:"sm",className:"gap-2",onClick:()=>{if(!p)return;const e=p;us?Z(e):X(e)},children:[g.jsx(f,{className:"h-4 w-4 "+(us?"fill-green-600 text-green-600":"")}),He("listing.actions.save")]})]})]}),g.jsx(I.Suspense,{fallback:null,children:g.jsx(xe,{isOpen:Oe,onClose:()=>$e(!1),listing:{...as,photos:is}})}),g.jsx(I.Suspense,{fallback:null,children:g.jsx(ge,{isOpen:Ae,onClose:()=>Te(!1),listingId:as.id,hostId:Number(as.host_id),hostName:rs})}),g.jsx(I.Suspense,{fallback:null,children:g.jsx(pe,{isOpen:Ee,onClose:()=>Le(!1),hostId:Number(as.host_id),listingId:as.id})}),g.jsx(I.Suspense,{fallback:null,children:g.jsx(ve,{isOpen:qe,onClose:()=>ze(!1),photos:is,initialPhotoIndex:Be})}),g.jsx("div",{className:"mb-8 rounded-xl overflow-hidden shadow-sm",children:is.length>0?g.jsxs("div",{className:"relative group",children:[1===is.length?g.jsx($,{src:i(is[0].url),alt:as.title,className:"w-full h-[300px] sm:h-[400px] md:h-[500px] object-cover cursor-pointer hover:scale-105 transition-transform duration-700",onClick:()=>{Ge(0),ze(!0)},priority:!0}):is.length<=4?g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:is.slice(0,4).map((e,s)=>g.jsx("div",{className:"relative overflow-hidden cursor-pointer "+(0===s?"sm:col-span-2 h-[300px] sm:h-[400px]":"h-[200px] sm:h-[250px]"),onClick:()=>{Ge(s),ze(!0)},children:g.jsx($,{src:i(e.url),alt:`Photo ${s+1}`,className:"w-full h-full object-cover hover:scale-105 transition-transform duration-500",quality:0===s?"high":"medium"})},e.id))}):g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-2 h-[300px] md:h-[450px]",children:[g.jsx("div",{className:"md:col-span-2 md:row-span-2 relative cursor-pointer overflow-hidden h-full",onClick:()=>{Ge(0),ze(!0)},children:g.jsx($,{src:i(is[0].url),alt:as.title,className:"w-full h-full object-cover hover:scale-105 transition-transform duration-500",quality:"high",priority:!0})}),g.jsx("div",{className:"hidden md:grid md:col-span-2 md:grid-cols-2 md:grid-rows-2 gap-2 h-full",children:is.slice(1,5).map((e,s)=>g.jsx("div",{className:"relative cursor-pointer overflow-hidden h-full",onClick:()=>{Ge(s+1),ze(!0)},children:g.jsx($,{src:i(e.url),alt:`Photo ${s+2}`,className:"w-full h-full object-cover hover:scale-105 transition-transform duration-500",quality:"medium"})},e.id))})]}),g.jsxs("button",{className:"absolute bottom-4 right-4 bg-white/90 backdrop-blur-sm px-4 py-2 rounded-lg border border-black/10 font-medium text-sm hover:bg-white hover:scale-105 transition-all shadow-sm flex items-center gap-2",onClick:()=>{Ge(0),ze(!0)},children:[g.jsx("span",{className:"hidden sm:inline",children:He("listing.actions.showAllPhotos",{defaultValue:"Show all photos"})}),g.jsx("span",{className:"sm:hidden",children:He("listing.details.photos",{defaultValue:"Photos"})})]})]}):g.jsx("div",{className:"w-full h-64 md:h-[400px] bg-muted flex items-center justify-center rounded-xl",children:g.jsx("p",{className:"text-muted-foreground",children:He("listing.details.noPhotos")})})}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-12",children:[g.jsxs("div",{className:"md:col-span-2",children:[g.jsxs("div",{className:"border-b pb-6 mb-6",children:[g.jsx("h2",{className:"text-xl font-semibold mb-1",children:g.jsx(G,{as:"span",text:as.title})}),g.jsxs("p",{className:"text-muted-foreground",children:[He("listing.details.unitCount.guests",{count:as.max_guests})," • ",He("listing.details.unitCount.bedrooms",{count:as.bedrooms})," • ",He("listing.details.unitCount.beds",{count:as.beds})," • ",He("listing.details.unitCount.baths",{count:as.bathrooms})]})]}),g.jsxs("div",{className:"border-b pb-6 mb-6",children:[g.jsx("h3",{className:"font-semibold mb-4",children:He("listing.details.about")}),ks.length>0?g.jsx("div",{className:"space-y-4",children:ks.map((e,s)=>g.jsxs("div",{className:"space-y-1",children:[g.jsx("div",{className:"font-semibold",children:e.title}),g.jsx(G,{as:"p",className:"text-muted-foreground whitespace-pre-line",text:e.text})]},s))}):g.jsx(G,{as:"p",className:"text-muted-foreground whitespace-pre-line",text:Cs||""})]}),g.jsxs("div",{className:"border-b pb-6 mb-6",children:[g.jsx("h3",{className:"font-semibold mb-4",children:He("listing.details.offers")}),g.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:ns.slice(0,10).map(e=>{const s=E[e];if(!s)return null;const t=s.icon;return g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx(t,{className:"h-6 w-6 text-gray-700"}),g.jsx("span",{className:"text-gray-900",children:He(`amenities.${e}`,{defaultValue:s.label})})]},e)})}),ns.length>10&&g.jsx(t,{variant:"outline",className:"mt-6",children:He("listing.details.showAllAmenities",{count:ns.length})})]}),g.jsxs("div",{className:"border-b pb-12 mb-12",children:[g.jsx("h3",{className:"text-xl font-semibold mb-2",children:ae&&re?He("listing.details.nightsInCity",{count:Math.ceil((re.getTime()-ae.getTime())/864e5),city:as.city}):He("listing.details.selectCheckIn")}),g.jsx("p",{className:"text-muted-foreground mb-6",children:ae&&re?`${Q(ae,"MMM d, yyyy",{locale:Ye})} - ${Q(re,"MMM d, yyyy",{locale:Ye})}`:He("listing.details.addDatesPricing")}),g.jsx("div",{className:"hidden md:block",children:g.jsx(H,{mode:"range",selected:ae?{from:ae,to:re||void 0}:void 0,onSelect:e=>{(null==e?void 0:e.from)&&ne(e.from),oe((null==e?void 0:e.to)||null),e||(ne(null),oe(null))},numberOfMonths:2,pagedNavigation:!0,disabled:[{before:new Date},...ls],modifiersStyles:{selected:{backgroundColor:"#222222",color:"white"},range_middle:{backgroundColor:"#F7F7F7",color:"#222222"},range_start:{backgroundColor:"#222222",color:"white"},range_end:{backgroundColor:"#222222",color:"white"}},locale:Ye,className:"border-0"})}),g.jsx("div",{className:"md:hidden flex justify-center",children:g.jsx(H,{mode:"range",selected:ae?{from:ae,to:re||void 0}:void 0,onSelect:e=>{(null==e?void 0:e.from)&&ne(e.from),oe((null==e?void 0:e.to)||null),e||(ne(null),oe(null))},numberOfMonths:1,disabled:[{before:new Date},...ls],modifiersStyles:{selected:{backgroundColor:"#222222",color:"white"},range_middle:{backgroundColor:"#F7F7F7",color:"#222222"},range_start:{backgroundColor:"#222222",color:"white"},range_end:{backgroundColor:"#222222",color:"white"}},locale:Ye})}),g.jsx("div",{className:"flex justify-end mt-4",children:g.jsx(t,{variant:"ghost",className:"underline font-semibold",onClick:()=>{ne(null),oe(null)},children:He("listing.actions.clearDates")})})]}),g.jsxs("div",{className:"border-b pb-12 mb-12",children:[g.jsxs("div",{className:"flex items-center justify-between mb-8",children:[g.jsxs("div",{className:"flex items-center gap-2",children:[g.jsx(b,{className:"h-5 w-5 fill-current"}),g.jsx("h2",{className:"text-2xl font-semibold",children:0===Je.length?He("listing.reviews.noReviewsYet"):`${(Je.reduce((e,s)=>e+Object.values(s.ratings).reduce((e,s)=>e+s,0)/6,0)/Je.length).toFixed(2)} · ${He("listing.reviews.count",{count:Je.length})}`})]}),g.jsx(t,{variant:"outline",disabled:hs,onClick:()=>{if(!ms){Ke({title:"Login required",description:"Please log in to write a review.",variant:"destructive"});const e=`${window.location.pathname}${window.location.search}`;return void(window.location.href=`/login?redirect=${encodeURIComponent(e||"/")}`)}hs?Ke({title:"Already reviewed",description:"You can only review this listing once."}):Re(!0)},children:He("listing.actions.writeReview")})]}),g.jsx(he,{isOpen:Fe,onClose:()=>Re(!1),onSubmit:async e=>{var s;if(p)try{const s=await h(p,{ratings:e.ratings,comment:e.comment}),t=es(s);Ue(e=>[t,...e]),Re(!1),Ke({title:He("Success"),description:He("Thank you for your feedback!")})}catch(t){const e=null==(s=t.response)?void 0:s.status;if(409===e)return Re(!1),void Ke({title:He("Already reviewed"),description:He("You can only review this listing once."),variant:"destructive"});if(401===e){Ke({title:He("Login required"),description:He("Please log in to write a review."),variant:"destructive"});const e=`${window.location.pathname}${window.location.search}`;return void(window.location.href=`/login?redirect=${encodeURIComponent(e||"/")}`)}Ke({title:He("Failed to submit review"),description:He("Please try again later."),variant:"destructive"})}}}),Je.length>0&&g.jsxs(g.Fragment,{children:[g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-4 mb-8",children:["cleanliness","accuracy","checkin","communication","location","value"].map(e=>{const s=Je.reduce((s,t)=>s+t.ratings[e],0)/Je.length;return g.jsxs("div",{className:"flex items-center justify-between",children:[g.jsx("span",{className:"text-sm md:text-base capitalize",children:He(`listing.reviews.categories.${e}`)}),g.jsxs("div",{className:"flex items-center gap-3 w-1/2",children:[g.jsx(ue,{value:20*s,className:"h-1"}),g.jsx("span",{className:"text-xs font-semibold",children:s.toFixed(1)})]})]},e)})}),g.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:Je.map(e=>g.jsxs("div",{children:[g.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[g.jsxs(V,{className:"h-10 w-10",children:[g.jsx(Y,{src:e.user.avatar}),g.jsx(W,{children:e.user.name.charAt(0)})]}),g.jsxs("div",{children:[g.jsx("div",{className:"font-semibold",children:e.user.name}),g.jsx("div",{className:"text-sm text-muted-foreground",children:new Date(e.timestamp).toLocaleDateString(We,{month:"long",year:"numeric"})})]})]}),g.jsx(G,{as:"p",className:"text-muted-foreground line-clamp-3",text:e.comment})]},e.id))})]})]})]}),g.jsx("div",{className:"relative hidden md:block",children:g.jsxs("div",{className:"sticky top-24 border rounded-xl p-6 shadow-lg bg-white",children:[g.jsx("div",{className:"flex justify-between items-end mb-6",children:g.jsxs("div",{children:[g.jsx("span",{className:"text-2xl font-bold",children:l(as.price_per_night||0)}),g.jsxs("span",{className:"text-muted-foreground",children:[" / ",He("per night")]})]})}),g.jsxs("div",{className:"border rounded-lg mb-4",children:[g.jsxs("div",{className:"grid grid-cols-2 border-b",children:[g.jsxs("div",{className:"p-3 border-r cursor-pointer hover:bg-gray-50",onClick:()=>{window.matchMedia("(max-width: 767px)").matches?Ze():(Ie(!0),setTimeout(()=>{var e;return null==(e=Xe.current)?void 0:e.scrollIntoView({behavior:"smooth",block:"start"})},0))},children:[g.jsx("div",{className:"text-[10px] font-bold uppercase",children:He("listing.booking.checkIn")}),g.jsx("div",{className:"text-sm",children:ae?ae.toLocaleDateString(Ve.language):He("listing.booking.addDate")})]}),g.jsxs("div",{className:"p-3 cursor-pointer hover:bg-gray-50",onClick:()=>{window.matchMedia("(max-width: 767px)").matches?Ze():(Ie(!0),setTimeout(()=>{var e;return null==(e=Xe.current)?void 0:e.scrollIntoView({behavior:"smooth",block:"start"})},0))},children:[g.jsx("div",{className:"text-[10px] font-bold uppercase",children:He("listing.booking.checkout")}),g.jsx("div",{className:"text-sm",children:re?re.toLocaleDateString(Ve.language):He("listing.booking.addDate")})]})]}),g.jsxs("div",{className:"p-3 relative",children:[g.jsxs("div",{className:"cursor-pointer",onClick:()=>ke(!_e),children:[g.jsx("div",{className:"text-[10px] font-bold uppercase",children:He("listing.booking.guests")}),g.jsx("div",{className:"text-sm",children:He("listing.booking.guestCount",{count:ds})})]}),_e&&g.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white border border-gray-300 rounded-lg shadow-lg p-4 z-10 w-80",children:[g.jsxs("div",{className:"flex items-center justify-between py-4 border-b border-gray-200",children:[g.jsxs("div",{children:[g.jsx("div",{className:"font-semibold",children:He("listing.booking.adults")}),g.jsx("div",{className:"text-sm text-gray-500",children:He("Age 13+")})]}),g.jsxs("div",{className:"flex items-center gap-3",children:[g.jsx("button",{onClick:()=>ce(Math.max(1,de-1)),disabled:de<=1,className:"w-8 h-8 rounded-full border flex items-center justify-center transition-colors "+(de<=1?"border-gray-200 text-gray-300":"border-gray-400 text-gray-600"),children:g.jsx(N,{className:"h-4 w-4"})}),g.jsx("span",{className:"w-8 text-center font-medium",children:de}),g.jsx("button",{onClick:()=>ce(de+1),className:"w-8 h-8 rounded-full border border-gray-400 text-gray-600 flex items-center justify-center",children:g.jsx(y,{className:"h-4 w-4"})})]})]}),g.jsx(t,{variant:"ghost",className:"w-full mt-2",onClick:()=>ke(!1),children:He("listing.actions.close")})]})]})]}),De&&g.jsxs("div",{className:"mb-4",ref:Xe,children:[g.jsxs("div",{className:"flex items-center justify-between mb-2",children:[g.jsx("button",{className:"text-sm font-semibold underline",onClick:()=>Ie(!1),"aria-label":"Close calendar",children:He("listing.actions.close")}),g.jsx("button",{className:"text-sm underline text-muted-foreground hover:text-foreground",onClick:()=>{ne(null),oe(null)},children:He("listing.actions.clearDates")})]}),(()=>{const e=(s=Ce,new Date(s.getFullYear(),s.getMonth()+1,0).getDate());var s;const t=(e=>new Date(e.getFullYear(),e.getMonth(),1).getDay())(Ce),i=[];He("common.months",{returnObjects:!0});const l=He("common.daysMin",{returnObjects:!0});for(let a=0;a<t;a++)i.push(g.jsx("div",{className:"h-10"},`empty-${a}`));for(let a=1;a<=e;a++){const e=new Date(Ce.getFullYear(),Ce.getMonth(),a),s=vs(ae,e),t=vs(re,e),l=js(e),n=fs(e);i.push(g.jsx("button",{onClick:()=>!n&&bs(e),disabled:n,className:`h-10 w-10 flex items-center justify-center rounded-full text-sm font-medium transition-all\n                        ${n?"text-gray-300 cursor-not-allowed":"hover:bg-gray-100 text-gray-900"}\n                        ${s||t?"bg-gray-900 text-white hover:bg-gray-800":""}\n                        ${!l||s||t?"":"bg-gray-100"}\n                    `,children:a},a))}return g.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[g.jsxs("div",{className:"flex items-center justify-between mb-6",children:[g.jsx("button",{onClick:ys,className:"p-2 hover:bg-gray-100 rounded-full transition-colors","aria-label":He("common.back"),children:g.jsx(S,{className:"h-4 w-4"})}),g.jsx("h4",{className:"text-base font-semibold",children:new Intl.DateTimeFormat(Ve.language,{month:"long",year:"numeric"}).format(Ce)}),g.jsx("button",{onClick:Ns,className:"p-2 hover:bg-gray-100 rounded-full transition-colors","aria-label":He("common.next"),children:g.jsx(D,{className:"h-4 w-4"})})]}),g.jsx("div",{className:"grid grid-cols-7 gap-1 mb-3",children:l.map(e=>g.jsx("div",{className:"h-10 flex items-center justify-center text-xs font-medium text-gray-500",children:e},e))}),g.jsx("div",{className:"grid grid-cols-7 gap-1",children:i})]})})()]}),ae&&re&&xs>0&&g.jsxs("div",{className:"mb-4 pb-4 border-b space-y-3",children:[g.jsxs("div",{className:"flex justify-between text-sm",children:[g.jsxs("span",{className:"text-muted-foreground",children:[l(as.price_per_night||0)," × ",xs," ",He(1===xs?"night":"nights")]}),g.jsx("span",{className:"font-medium",children:l(gs)})]}),!1,g.jsxs("div",{className:"flex justify-between text-base font-bold pt-3 border-t",children:[g.jsx("span",{children:He("listing.booking.total")}),g.jsx("span",{children:l(ps)})]})]}),g.jsx(t,{className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-6 text-lg",onClick:ws,disabled:cs||!ae||!re,children:He("listing.actions.reserve")}),g.jsx("div",{className:"text-center mt-4 text-sm text-muted-foreground",children:He("listing.booking.noCharge")})]})})]}),g.jsxs("div",{className:"py-8 border-t border-gray-200",children:[g.jsx("h3",{className:"text-xl font-semibold mb-4",children:He("listing.details.location")}),g.jsxs("div",{className:"mb-6",children:[g.jsx("p",{className:"font-medium text-gray-900 text-lg",children:as.address||`${as.city}, ${as.country}`}),as.latitude&&as.longitude&&g.jsxs("p",{className:"text-gray-500 mt-1",children:[as.latitude,", ",as.longitude]})]}),g.jsx("div",{className:"h-64 md:h-[400px] rounded-xl overflow-hidden z-0 relative",children:g.jsx(I.Suspense,{fallback:g.jsx("div",{className:"h-full w-full bg-slate-100 flex items-center justify-center",children:g.jsx(w,{className:"h-8 w-8 text-slate-300 animate-pulse"})}),children:g.jsx(je,{latitude:as.latitude,longitude:as.longitude,title:as.title})})})]}),(as.getting_around||as.scenic_views&&as.scenic_views.length>0)&&g.jsx("div",{className:"py-8 border-t border-gray-200",children:g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[as.getting_around&&g.jsxs("div",{children:[g.jsx("h3",{className:"text-xl font-semibold mb-4",children:He("listing.details.gettingAround")}),g.jsx(G,{as:"p",className:"text-muted-foreground whitespace-pre-line",text:as.getting_around||""})]}),as.scenic_views&&g.jsxs("div",{children:[g.jsx("h3",{className:"text-xl font-semibold mb-4",children:He("listing.details.scenicViews")}),g.jsx("div",{className:"flex flex-wrap gap-2",children:(()=>{try{const e="string"==typeof as.scenic_views?JSON.parse(as.scenic_views):as.scenic_views;return Array.isArray(e)?e.map((e,s)=>g.jsx("div",{className:"bg-gray-100 px-3 py-1 rounded-full text-sm text-gray-700",children:g.jsx(G,{as:"span",text:e})},s)):null}catch(Ss){return null}})()})]})]})}),g.jsxs("div",{className:"mt-12 pt-8 border-t border-gray-200",children:[g.jsx("h3",{className:"text-xl font-semibold mb-6",children:He("listing.host.meet")}),g.jsxs("div",{className:"bg-[#F0EFE9] rounded-2xl p-6 md:p-8 grid grid-cols-1 md:grid-cols-3 gap-8",children:[g.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg flex flex-col items-center text-center md:col-span-1 cursor-pointer hover:shadow-xl transition",onClick:()=>v(`/hosts/${as.host_id}`),children:[g.jsx("div",{className:"relative mb-4",children:g.jsxs(V,{className:"h-24 w-24",children:[g.jsx(Y,{src:os||void 0}),g.jsx(W,{children:rs.slice(0,2).toUpperCase()})]})}),g.jsx("h4",{className:"text-2xl font-bold mb-1",children:rs}),g.jsx("div",{className:"w-full space-y-4 mt-4",children:g.jsxs("div",{className:"flex justify-between items-center border-b pb-4",children:[g.jsxs("div",{className:"text-left",children:[g.jsx("div",{className:"font-bold text-lg",children:Je.length}),g.jsx("div",{className:"text-xs text-muted-foreground",children:He("listing.host.reviews")})]}),g.jsxs("div",{className:"text-right",children:[g.jsx("div",{className:"font-bold text-lg",children:Je.length>0?(Je.reduce((e,s)=>e+Object.values(s.ratings).reduce((e,s)=>e+s,0)/6,0)/Je.length).toFixed(2):He("listing.details.new")}),g.jsx("div",{className:"text-xs text-muted-foreground",children:He("listing.host.rating")})]}),g.jsxs("div",{className:"text-right",children:[g.jsx("div",{className:"font-bold text-lg",children:He("listing.details.new")}),g.jsx("div",{className:"text-xs text-muted-foreground",children:He("listing.host.yearsHosting")})]})]})})]}),g.jsx("div",{className:"md:col-span-2 space-y-6",children:g.jsxs("div",{className:"pt-4",children:[g.jsx("h4",{className:"text-lg font-semibold mb-2",children:He("listing.host.aboutTitle")}),localStorage.getItem("host_location")&&g.jsxs("div",{className:"flex items-center gap-2 mb-2 text-gray-700",children:[g.jsx(w,{className:"h-5 w-5"}),g.jsx("span",{children:He("listing.host.livesIn",{location:localStorage.getItem("host_location")})})]}),localStorage.getItem("host_languages")&&g.jsxs("div",{className:"flex items-center gap-2 mb-4 text-gray-700",children:[g.jsx(_,{className:"h-5 w-5"}),g.jsx("span",{children:He("listing.host.speaks",{langs:localStorage.getItem("host_languages")})})]}),g.jsx("p",{className:"text-muted-foreground mb-6",children:He("listing.host.bioDefault")}),g.jsx(t,{variant:"outline",className:"font-semibold border-black text-black hover:bg-gray-100",onClick:()=>{const e=null==se?void 0:se.contact_phone;A(e,He("listing.actions.whatsappGreeting",{name:rs}))||Te(!0)},children:He("listing.actions.messageHost")}),g.jsx("div",{className:"mt-4 flex justify-center md:justify-start",children:g.jsxs("button",{onClick:()=>Le(!0),className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground underline",children:[g.jsx(k,{className:"h-4 w-4"}),He("listing.actions.reportHost")]})})]})})]})]}),g.jsxs("div",{className:"mt-12 pt-8 border-t border-gray-200",children:[g.jsx("h3",{className:"text-xl font-semibold mb-6",children:He("listing.details.thingsToKnow")}),g.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[g.jsxs("div",{children:[g.jsx("h4",{className:"font-semibold mb-4",children:He("listing.details.houseRules")}),g.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[g.jsxs("p",{children:[He("listing.booking.checkIn"),": ",_s.check_in_start," - ",_s.check_in_end]}),g.jsxs("p",{children:[He("listing.booking.checkout"),": ",_s.checkout_time]}),g.jsx("p",{children:He("listing.details.maxGuests",{count:as.max_guests})}),g.jsx("p",{children:_s.pets_allowed?He("host.editor.safety.rules.pets"):He("preview.noPets")}),g.jsx("p",{children:_s.events_allowed?He("host.editor.safety.rules.events"):He("preview.noParties")}),g.jsx("p",{children:_s.smoking_allowed?He("listing.details.houseRulesProps.smokingAllowed"):He("preview.noSmoking")}),g.jsx("p",{children:_s.quiet_hours?He("listing.details.houseRulesProps.quietHoursEnforced"):He("listing.details.houseRulesProps.quietHoursNotEnforced")}),g.jsx("p",{children:_s.commercial_photography_allowed?He("listing.details.houseRulesProps.photographyAllowed"):He("listing.details.houseRulesProps.photographyNotAllowed")})]})]}),g.jsxs("div",{children:[g.jsx("h4",{className:"font-semibold mb-4",children:He("listing.details.safetyProperty")}),g.jsx("div",{className:"space-y-2 text-sm text-gray-700",children:as.safety_devices&&(()=>{let e=[];try{e=as.safety_devices.trim().startsWith("[")?JSON.parse(as.safety_devices):as.safety_devices.split(",")}catch(Ss){e=[as.safety_devices]}return e.map((e,s)=>g.jsx(G,{as:"p",text:e},s))})()})]}),g.jsxs("div",{children:[g.jsx("h4",{className:"font-semibold mb-4",children:He("listing.details.cancellationPolicy")}),g.jsx("p",{className:"text-sm text-gray-700",children:as.cancellation_policy||He("listing.details.flexibleCancellation")})]})]})]})]}),g.jsx("div",{className:"fixed bottom-0 inset-x-0 z-50 bg-white border-t border-gray-200 p-4 md:hidden pb-safe",children:g.jsxs("div",{className:"flex items-center justify-between max-w-7xl mx-auto",children:[g.jsxs("div",{className:"flex flex-col",children:[ae&&re?g.jsxs("div",{className:"flex items-baseline gap-1",children:[g.jsx("span",{className:"font-bold text-lg",children:l(ps)}),g.jsx("span",{className:"text-sm text-muted-foreground",children:He("listing.booking.total")})]}):g.jsxs("div",{className:"flex items-baseline gap-1",children:[g.jsx("span",{className:"font-bold text-lg",children:l(as.price_per_night||0)}),g.jsxs("span",{className:"text-sm text-muted-foreground",children:["/ ",He("per night")]})]}),g.jsx("span",{className:"text-xs font-medium underline cursor-pointer",onClick:()=>Pe(!0),children:ae&&re?`${Q(ae,"MMM d",{locale:Ye})} - ${Q(re,"MMM d",{locale:Ye})}`:He("listing.booking.addDate")})]}),g.jsx(t,{className:"bg-green-600 hover:bg-green-700 text-white font-semibold px-8",onClick:()=>ae&&re?ws():Ze(),children:He(ae&&re?"listing.actions.reserve":"listing.booking.selectDates")})]})}),g.jsx(a,{open:Me,onOpenChange:e=>{var s,t;if(e)try{null==(t=null==(s=document.activeElement)?void 0:s.blur)||t.call(s)}catch{}Pe(e)},children:g.jsxs(n,{className:"md:hidden w-full max-w-none p-0 gap-0",onOpenAutoFocus:e=>{var s;e.preventDefault(),null==(s=Qe.current)||s.focus()},children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[g.jsx("button",{ref:Qe,className:"p-2 -ml-2","aria-label":"Close",onClick:()=>Pe(!1),children:g.jsx(C,{className:"h-5 w-5"})}),g.jsx("button",{className:"text-sm font-semibold underline",onClick:()=>{ne(null),oe(null)},children:He("listing.actions.clearDates")})]}),g.jsxs("div",{className:"px-4 pt-4",children:[g.jsxs(r,{className:"mb-2",children:[g.jsx(o,{className:"text-lg font-semibold",children:He("listing.details.selectCheckIn")}),g.jsx(d,{className:"text-sm text-muted-foreground",children:He("listing.details.addDatesPricing")})]}),g.jsx(H,{mode:"range",selected:ae?{from:ae,to:re||void 0}:void 0,onSelect:e=>{(null==e?void 0:e.from)&&ne(e.from),oe((null==e?void 0:e.to)||null),e||(ne(null),oe(null))},numberOfMonths:1,disabled:[{before:new Date},...ls],modifiersStyles:{selected:{backgroundColor:"#222222",color:"white"},range_middle:{backgroundColor:"#F7F7F7",color:"#222222"},range_start:{backgroundColor:"#222222",color:"white"},range_end:{backgroundColor:"#222222",color:"white"}},locale:Ye,className:"border-0"})]}),g.jsx("div",{className:"p-4 border-t",children:g.jsx(t,{className:"w-full",disabled:!ae||!re,onClick:()=>{Ie(!1),ws()},children:He("listing.actions.reserve")})})]})}),g.jsx(L,{})]})};export{fe as default};
